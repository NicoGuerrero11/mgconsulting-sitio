---
import Layout from "../layouts/BaseLayout.astro";
import Container from "../components/ui/Container.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import ServiceCard from "../components/services/ServiceCard.astro";

const services = (await getCollection("services"))
  .filter((s) => !s.data.draft)
  .sort((a, b) => a.data.order - b.data.order);

type ServiceEntry = CollectionEntry<"services">;

const servicesWithContent = await Promise.all(
  services.map(async (entry: ServiceEntry) => {
    const { Content } = await entry.render();
    return { entry, Content };
  })
);
---

<Layout title="Servicios - MG Consulting" mobileTitle="Nuestros Servicios">
  <Container class="w-full px-6 md:px-8">
    <div class="space-y-20 md:spate-y-0">
      <div class="text-center">
        <!-- Versión mobile -->
        <h1
          class="block md:hidden text-text font-semibold tracking-tight text-3xl pt-0 pb-0"
        >
          Servicios Clave para su Crecimiento
        </h1>

        <!-- Versión desktop -->
        <h1
          class="hidden md:block text-[var(--color-blue)] font-semibold tracking-tight text-5xl pt-0 pb-0"
        >
          Nuestros Servicios
        </h1>
        <p class="hidden md:block mt-4 text-2xl text-muted">
          Impulsamos el crecimiento de tu negocio.
        </p>
      </div>
      {
        servicesWithContent.map(({ entry, Content }, idx) => {
          const bg =
            idx % 2 === 0 ? "bg-[var(--bg-white)]" : "bg-[var(--bg-grey)]";
          return (
            <article id={entry.slug} class="scroll-mt-24 md:scroll-mt-32">
              <ServiceCard
                title={entry.data.title}
                image={entry.data.image}
                ctaText={entry.data.ctaText}
                imageSide={entry.data.imageSide}
                bgColor={bg}
              >
                <Content slot="content" />
              </ServiceCard>
            </article>
          );
        })
      }
    </div>
  </Container>
</Layout>
