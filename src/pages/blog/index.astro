---
import { getCollection } from "astro:content";
import Layout from "../../layouts/BaseLayout.astro";
import Button from "../../components/ui/Button.astro";
import { Picture } from "astro:assets";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
---

<Layout 
  title="Blog - Estrategias Empresariales y Consejos de Liderazgo | MG Consulting"
  description="Descubre las últimas tendencias en consultoría empresarial, estrategias de crecimiento, liderazgo ejecutivo y transformación organizacional. Artículos expertos de MG Consulting."
  mobileTitle="Blog"
  image="/og-blog.jpg"
>
  <section class="mx-auto max-w-6xl px-4 py-10">
    <div class="hidden md:block mb-20">
      <h1 class="text-5xl font-bold mb-8 text-center text-[var(--color-blue)]">
        Perspectivas y Estrategias para el Éxito Empresarial
      </h1>
      <p class="text-muted text-center">
        Sumérgete en nuestro blog para encontrar análisis profundos, consejos
        prácticos y las últimas tendencias que impulsarán el crecimiento y la
        innovación en tu negocio.
      </p>
    </div>

    {
      posts.length === 0 ? (
        <p class="text-sm text-muted">Aún no hay publicaciones.</p>
      ) : (
        <div class="grid grid-cols-1 gap-6 justify-center sm:grid-cols-2 lg:grid-cols-3 bg-[var(--bg-grey)] p-6 rounded-2xl">
          {posts.map((p) => (
            <article
              class="
                /* Mobile: replica del diseño pedido */
                w-[358px] max-w-full h-[457px] mx-auto rounded-[10px] bg-white p-6 
                shadow-[0_0_1px_rgba(23,26,31,0.87),0_0_2px_rgba(23,26,31,0.08)]
                transition
                /* Desktop/Tablet: volver al layout normal */
                sm:w-auto sm:h-auto sm:rounded-2xl  sm:shadow-none sm:hover:shadow sm:static
              "
            >
              {p.data.imagen ? (
                <div class="mb-4 aspect-[16/9] w-full overflow-hidden rounded-xl bg-neutral-100">
                  <Picture
                    src={p.data.imagen}
                    alt={p.data.title}
                    widths={[400, 600, 800, 1200]}
                    sizes="(min-width:1024px) 33vw, (min-width:640px) 50vw, 100vw"
                    class="h-full w-full object-cover"
                    loading="lazy"
                    decoding="async"
                  />
                </div>
              ) : (
                <div class="mb-2 aspect-[16/9] w-full rounded-xl bg-neutral-100" />
              )}

              <h3 class="text-xl font-semibold mb-2">{p.data.title}</h3>
              <p class="text-sm text-neutral-600 line-clamp-3 mb-8">
                {p.data.description}
              </p>
              <Button
                href={`/blog/${p.slug}/`}
                label="Leer más"
                variant="secondary"
                class="block text-center sm:inline-flex w-full sm:items-center sm:justify-center sm:w-auto mt-6"
              />
            </article>
          ))}
        </div>
      )
    }
  </section>
</Layout>
